# GSFusion_eval
Automatic evaluation system for GSFusion


## Installation

Clone the repository
```
git clone https://github.com/goldoak/GSFusion_eval.git --recursive
```

Create virtual environment
```
cd GSFusion_eval
conda create -n gs_eval python=3.8
conda activate gs_eval
pip install -r requirements.txt
```

Build differentiable Gaussian rasterizer
```
cd diff-gaussian-rasterization
python setup.py install
```


## File Structure
This evaluation system expects the following file structure:
```bash
<model path>
├── cfg_args
├── mesh
│   └── mesh_xxx.ply
└── point_cloud
    └── iteration_xxx
        └── point_cloud.ply
```
where `cfg_args` and `point_cloud.ply` should be in the same format as the files generated by official [3D Gaussian Splatting](https://github.com/graphdeco-inria/gaussian-splatting) implementation. Note that `mesh` folder is optional as it is generated by our [GSFusion](https://github.com/goldoak/GSFusion) together with the 3D Gaussian map.


## Evaluation

First render training/novel views using the trained model:
```
python render.py -m <model path> --iteration <#iters> --dataset_type <supported data type> --data_device cuda
```
**[Note]** You can evaluate any iterations that you store in the `point_cloud` folder by replacing `<#iters>` with the actual iteration number. This evaluation system currently supports three types of data: Colmap(`colmap`), ScanNet++(`scannetpp`) and Replica(`replica`). If you want to render novel views (e.g. in ScanNet++) for evaluation, you need to set `eval=True` in `cfg_args`. This command will automatically generate `train` and `test` (optionally) folders under the `<model path>` which stores the rendered images and ground truth images.

Then calculate metrics for rendered images:
```
python eval.py --data <path to train/test folder>
```
**[Note]** This command will compute PSNR, SSIM and LPIPS for rendered images and record the results in `metrics.json` in the same data path.

Finally, the file structure is as follows:
```bash
<model path>
├── cfg_args
├── mesh
│   └── mesh_xxx.ply
├── point_cloud
│   └── iteration_xxx
│       └── point_cloud.ply
├── train
│   └── ours_xxx
│       ├── gt
│       ├── renders
│       └── metrics.json
└── test
    └── ours_xxx
        ├── gt
        ├── renders
        └── metrics.json
```

To compute the accuracy of point cloud extracted from the trained model (GSFusion only), use the following command
```
python eval_pcd.py -m <model path> --iteration <#iters>
```